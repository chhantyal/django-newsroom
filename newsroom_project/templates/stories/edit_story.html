{% extends "stories/base_edit.html" %}
{% load formfields i18n %}

{% block head_title %}Edit Story: {{story.headline}}{% endblock %}


{% block extra_head %}
    {{ block.super }}
    <script type="text/javascript" src="{{ MEDIA_URL }}js/stories.js"></script>
{% endblock %}

{% block subnav %}
    {{ block.super }}
    <div class="actions-block" id="story-edit-media-actions">
        <h2>{% trans "Add media to story" %}</h2>
        <ul class="action-links">
            <li><a href="{% url stories_story_add_media story.id "photo" %}">{% trans "Add Photo" %}</a></li>
            <li><a href="{% url stories_story_add_media story.id "video" %}">{% trans "Add Video" %}</a></li>
        </ul>
    </div>
{% endblock %}

{% block main_content %}

<h1>{{ story.headline }} <span class="headline-options">(<a href="{% url stories_story_pages story.id %}">edit story pages</a>)</span></h1>

    {# TODO auto-slugify headline (or customize admin) #}

    <div class="edit-story-tabs">
        <div class="tab-links">
            <a href="" rel="story-info" class="active">Properties</a>
            <a href="{% url stories_story_media story.id %}" rel="story-media">Media</a>
            <a href="{% url stories_story_pages story.id %}" rel="story-pages">Pages</a>
            <br class="clearboth" />
        </div>
        <div class="tab-contents">

            <div id="story-info" class="tab">
                <form method="post">
                <fieldset class="inlineLabels">
                    {{ form.as_p }}
                    <div class="form_block">
                        <input type="submit" value="Save"/>
                    </div>
                </fieldset>
                </form>
            </div>


            <div id="story-media" class="tab hidden">

                <p>Recent {{media_type|capfirst}} Items</p>
                <ul id="media-items">
                    {% for item in story.media.all %}
                    <li class="media-item" id="media-item-{{item.id}}"><img src="{{item.get_thumbnail_url}}" />{{item.title}}</li>
                    {% endfor %}
                </ul>

            </div>

            <br class="clear" />

        </div>

    </div>

{% endblock %}
